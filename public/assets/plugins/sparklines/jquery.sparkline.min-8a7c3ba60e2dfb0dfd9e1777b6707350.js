(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){"use strict";var t,i,n,o,s,a,r,l,c,u,h,d,p,f,g,m,v,b,y,C,T,_,x,E,w,D,I,k,S,O,R,N,A={},M=0;t=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0,tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0,tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:void 0,thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,tooltipFormat:new n("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:void 0,tooltipFormat:new n("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new n('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0,tooltipFormat:new n("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},D='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',i=function(){var t,i;return t=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(t.prototype=e.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],arguments.length>2&&(i=Array.prototype.slice.call(arguments,1,-1),i.unshift(t.prototype),e.extend.apply(e,i))):t.prototype=arguments[0],t.prototype.cls=t,t},e.SPFormatClass=n=i({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,t){this.format=e,this.fclass=t},render:function(e,t,i){var n,o,s,a,r,l=this,u=e;return this.format.replace(this.fre,function(){var e;return o=arguments[1],s=arguments[3],n=l.precre.exec(o),n?(r=n[2],o=n[1]):r=!1,a=u[o],void 0===a?"":s&&t&&t[s]?(e=t[s],e.get?t[s].get(a)||a:t[s][a]||a):(c(a)&&(a=i.get("numberFormatter")?i.get("numberFormatter")(a):f(a,r,i.get("numberDigitGroupCount"),i.get("numberDigitGroupSep"),i.get("numberDecimalMark"))),a)})}}),e.spformat=function(e,t){return new n(e,t)},o=function(e,t,i){return t>e?t:e>i?i:e},s=function(e,t){var i;return 2===t?(i=Math.floor(e.length/2),e.length%2?e[i]:(e[i-1]+e[i])/2):e.length%2?(i=(e.length*t+t)/4,i%1?(e[Math.floor(i)]+e[Math.floor(i)-1])/2:e[i-1]):(i=(e.length*t+2)/4,i%1?(e[Math.floor(i)]+e[Math.floor(i)-1])/2:e[i-1])},a=function(e){var t;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:t=parseFloat(e),e==t&&(e=t)}return e},r=function(e){var t,i=[];for(t=e.length;t--;)i[t]=a(e[t]);return i},l=function(e,t){var i,n,o=[];for(i=0,n=e.length;n>i;i++)e[i]!==t&&o.push(e[i]);return o},c=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},f=function(t,i,n,o,s){var a,r;for(t=(i===!1?parseFloat(t).toString():t.toFixed(i)).split(""),a=0>(a=e.inArray(".",t))?t.length:a,t.length>a&&(t[a]=s),r=a-n;r>0;r-=n)t.splice(r,0,o);return t.join("")},u=function(e,t,i){var n;for(n=t.length;n--;)if((!i||null!==t[n])&&t[n]!==e)return!1;return!0},h=function(e){var t,i=0;for(t=e.length;t--;)i+="number"==typeof e[t]?e[t]:0;return i},p=function(t){return e.isArray(t)?t:[t]},d=function(e){var t;document.createStyleSheet?document.createStyleSheet().cssText=e:(t=document.createElement("style"),t.type="text/css",document.getElementsByTagName("head")[0].appendChild(t),t["string"==typeof document.body.style.WebkitAppearance?"innerText":"innerHTML"]=e)},e.fn.simpledraw=function(t,i,n,o){var s,a;if(n&&(s=this.data("_jqs_vcanvas")))return s;if(void 0===t&&(t=e(this).innerWidth()),void 0===i&&(i=e(this).innerHeight()),e.browser.hasCanvas)s=new O(t,i,this,o);else{if(!e.browser.msie)return!1;s=new R(t,i,this)}return a=e(this).data("_jqs_mhandler"),a&&a.registerCanvas(s),s},e.fn.cleardraw=function(){var e=this.data("_jqs_vcanvas");e&&e.reset()},e.RangeMapClass=g=i({init:function(e){var t,i,n=[];for(t in e)e.hasOwnProperty(t)&&"string"==typeof t&&t.indexOf(":")>-1&&(i=t.split(":"),i[0]=0===i[0].length?-1/0:parseFloat(i[0]),i[1]=0===i[1].length?1/0:parseFloat(i[1]),i[2]=e[t],n.push(i));this.map=e,this.rangelist=n||!1},get:function(e){var t,i,n,o=this.rangelist;if(void 0!==(n=this.map[e]))return n;if(o)for(t=o.length;t--;)if(i=o[t],e>=i[0]&&i[1]>=e)return i[2];return void 0}}),e.range_map=function(e){return new g(e)},m=i({init:function(t,i){var n=e(t);this.$el=n,this.options=i,this.currentPageX=0,this.currentPageY=0,this.el=t,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!i.get("disableTooltips"),this.highlightEnabled=!i.get("disableHighlight")},registerSparkline:function(e){this.splist.push(e),this.over&&this.updateDisplay()},registerCanvas:function(t){var i=e(t.canvas);this.canvas=t,this.$canvas=i,i.mouseenter(e.proxy(this.mouseenter,this)),i.mouseleave(e.proxy(this.mouseleave,this)),i.click(e.proxy(this.mouseclick,this))},reset:function(e){this.splist=[],this.tooltip&&e&&(this.tooltip.remove(),this.tooltip=void 0)},mouseclick:function(t){var i=e.Event("sparklineClick");i.originalEvent=t,i.sparklines=this.splist,this.$el.trigger(i)},mouseenter:function(t){e(document.body).unbind("mousemove.jqs"),e(document.body).bind("mousemove.jqs",e.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new v(this.options),this.tooltip.updatePosition(t.pageX,t.pageY)),this.updateDisplay()},mouseleave:function(){e(document.body).unbind("mousemove.jqs");var t,i,n=this.splist,o=n.length,s=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),i=0;o>i;i++)t=n[i],t.clearRegionHighlight()&&(s=!0);s&&this.canvas.render()},mousemove:function(e){this.currentPageX=e.pageX,this.currentPageY=e.pageY,this.currentEl=e.target,this.tooltip&&this.tooltip.updatePosition(e.pageX,e.pageY),this.updateDisplay()},updateDisplay:function(){var t,i,n,o,s,a=this.splist,r=a.length,l=!1,c=this.$canvas.offset(),u=this.currentPageX-c.left,h=this.currentPageY-c.top;if(this.over){for(n=0;r>n;n++)i=a[n],o=i.setRegionHighlight(this.currentEl,u,h),o&&(l=!0);if(l){if(s=e.Event("sparklineRegionChange"),s.sparklines=this.splist,this.$el.trigger(s),this.tooltip){for(t="",n=0;r>n;n++)i=a[n],t+=i.getCurrentRegionTooltip();this.tooltip.setContent(t)}this.disableHighlight||this.canvas.render()}null===o&&this.mouseleave()}}}),v=i({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(t){var i,n=t.get("tooltipClassname","jqstooltip"),o=this.sizeStyle;this.container=t.get("tooltipContainer")||document.body,this.tooltipOffsetX=t.get("tooltipOffsetX",10),this.tooltipOffsetY=t.get("tooltipOffsetY",12),e("#jqssizetip").remove(),e("#jqstooltip").remove(),this.sizetip=e("<div/>",{id:"jqssizetip",style:o,"class":n}),this.tooltip=e("<div/>",{id:"jqstooltip","class":n}).appendTo(this.container),i=this.tooltip.offset(),this.offsetLeft=i.left,this.offsetTop=i.top,this.hidden=!0,e(window).unbind("resize.jqs scroll.jqs"),e(window).bind("resize.jqs scroll.jqs",e.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=e(window).scrollTop(),this.scrollLeft=e(window).scrollLeft(),this.scrollRight=this.scrollLeft+e(window).width(),this.updatePosition()},getSize:function(e){this.sizetip.html(e).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(e){return e?(this.getSize(e),this.tooltip.html(e).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition()),void 0):(this.tooltip.css("visibility","hidden"),this.hidden=!0,void 0)},updatePosition:function(e,t){if(void 0===e){if(void 0===this.mousex)return;e=this.mousex-this.offsetLeft,t=this.mousey-this.offsetTop}else this.mousex=e-=this.offsetLeft,this.mousey=t-=this.offsetTop;this.height&&this.width&&!this.hidden&&(t-=this.height+this.tooltipOffsetY,e+=this.tooltipOffsetX,this.scrollTop>t&&(t=this.scrollTop),this.scrollLeft>e?e=this.scrollLeft:e+this.width>this.scrollRight&&(e=this.scrollRight-this.width),this.tooltip.css({left:e,top:t}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=void 0,e(window).unbind("resize.jqs scroll.jqs")}}),I=function(){d(D)},e(I),N=[],e.fn.sparkline=function(t,i){return this.each(function(){var n,o,s=new e.fn.sparkline.options(this,i),a=e(this);if(n=function(){var i,n,o,r,l,c,u;return"html"===t||void 0===t?(u=this.getAttribute(s.get("tagValuesAttribute")),(void 0===u||null===u)&&(u=a.html()),i=u.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):i=t,n="auto"===s.get("width")?i.length*s.get("defaultPixelsPerValue"):s.get("width"),"auto"===s.get("height")?s.get("composite")&&e.data(this,"_jqs_vcanvas")||(r=document.createElement("span"),r.innerHTML="a",a.html(r),o=e(r).innerHeight()||e(r).height(),e(r).remove(),r=null):o=s.get("height"),s.get("disableInteraction")?l=!1:(l=e.data(this,"_jqs_mhandler"),l?s.get("composite")||l.reset():(l=new m(this,s),e.data(this,"_jqs_mhandler",l))),s.get("composite")&&!e.data(this,"_jqs_vcanvas")?(e.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),e.data(this,"_jqs_errnotify",!0)),void 0):(c=new(e.fn.sparkline[s.get("type")])(this,i,s,n,o),c.render(),l&&l.registerSparkline(c),void 0)},e(this).html()&&!s.get("disableHiddenCheck")&&e(this).is(":hidden")||"1.3.0">e.fn.jquery&&e(this).parents().is(":hidden")||!e(this).parents("body").length){if(!s.get("composite")&&e.data(this,"_jqs_pending"))for(o=N.length;o;o--)N[o-1][0]==this&&N.splice(o-1,1);N.push([this,n]),e.data(this,"_jqs_pending",!0)}else n.call(this)})},e.fn.sparkline.defaults=t(),e.sparkline_display_visible=function(){var t,i,n,o=[];for(i=0,n=N.length;n>i;i++)t=N[i][0],e(t).is(":visible")&&!e(t).parents().is(":hidden")?(N[i][1].call(t),e.data(N[i][0],"_jqs_pending",!1),o.push(i)):!e(t).closest("html").length&&!e.data(t,"_jqs_pending")&&(e.data(N[i][0],"_jqs_pending",!1),o.push(i));for(i=o.length;i;i--)N.splice(o[i-1],1)},e.fn.sparkline.options=i({init:function(t,i){var n,o,s,a;this.userOptions=i=i||{},this.tag=t,this.tagValCache={},o=e.fn.sparkline.defaults,s=o.common,this.tagOptionsPrefix=i.enableTagOptions&&(i.tagOptionsPrefix||s.tagOptionsPrefix),a=this.getTagSetting("type"),n=a===A?o[i.type||s.type]:o[a],this.mergedOptions=e.extend({},s,n,i)},getTagSetting:function(e){var t,i,n,o,s=this.tagOptionsPrefix;if(s===!1||void 0===s)return A;if(this.tagValCache.hasOwnProperty(e))t=this.tagValCache.key;else{if(t=this.tag.getAttribute(s+e),void 0===t||null===t)t=A;else if("["===t.substr(0,1))for(t=t.substr(1,t.length-2).split(","),i=t.length;i--;)t[i]=a(t[i].replace(/(^\s*)|(\s*$)/g,""));else if("{"===t.substr(0,1))for(n=t.substr(1,t.length-2).split(","),t={},i=n.length;i--;)o=n[i].split(":",2),t[o[0].replace(/(^\s*)|(\s*$)/g,"")]=a(o[1].replace(/(^\s*)|(\s*$)/g,""));else t=a(t);this.tagValCache.key=t}return t},get:function(e,t){var i,n=this.getTagSetting(e);return n!==A?n:void 0===(i=this.mergedOptions[e])?t:i}}),e.fn.sparkline._base=i({disabled:!1,init:function(t,i,n,o,s){this.el=t,this.$el=e(t),this.values=i,this.options=n,this.width=o,this.height=s,this.currentRegion=void 0},initTarget:function(){var e=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),e))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(){},setRegionHighlight:function(e,t,i){var n,o=this.currentRegion,s=!this.options.get("disableHighlight");return t>this.canvasWidth||i>this.canvasHeight||0>t||0>i?null:(n=this.getRegion(e,t,i),o!==n?(void 0!==o&&s&&this.removeHighlight(),this.currentRegion=n,void 0!==n&&s&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return void 0!==this.currentRegion?(this.removeHighlight(),this.currentRegion=void 0,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(){},getCurrentRegionTooltip:function(){var t,i,o,s,a,r,l,c,u,h,d,p,f,g,m=this.options,v="",b=[];if(void 0===this.currentRegion)return"";if(t=this.getCurrentRegionFields(),d=m.get("tooltipFormatter"))return d(this,m,t);if(m.get("tooltipChartTitle")&&(v+='<div class="jqs jqstitle">'+m.get("tooltipChartTitle")+"</div>\n"),i=this.options.get("tooltipFormat"),!i)return"";if(e.isArray(i)||(i=[i]),e.isArray(t)||(t=[t]),l=this.options.get("tooltipFormatFieldlist"),c=this.options.get("tooltipFormatFieldlistKey"),l&&c){for(u=[],r=t.length;r--;)h=t[r][c],-1!=(g=e.inArray(h,l))&&(u[g]=t[r]);t=u}for(o=i.length,f=t.length,r=0;o>r;r++)for(p=i[r],"string"==typeof p&&(p=new n(p)),s=p.fclass||"jqsfield",g=0;f>g;g++)t[g].isNull&&m.get("tooltipSkipNull")||(e.extend(t[g],{prefix:m.get("tooltipPrefix"),suffix:m.get("tooltipSuffix")}),a=p.render(t[g],m.get("tooltipValueLookups"),m),b.push('<div class="'+s+'">'+a+"</div>"));return b.length?v+b.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(e,t){var i,n,s,a,r=t.get("highlightColor"),l=t.get("highlightLighten");if(r)return r;if(l&&(i=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e))){for(s=[],n=4===e.length?16:1,a=0;3>a;a++)s[a]=o(Math.round(parseInt(i[a+1],16)*n*l),0,255);return"rgb("+s.join(",")+")"}return e}}),b={changeHighlight:function(t){var i,n=this.currentRegion,o=this.target,s=this.regionShapes[n];s&&(i=this.renderRegion(n,t),e.isArray(i)||e.isArray(s)?(o.replaceWithShapes(s,i),this.regionShapes[n]=e.map(i,function(e){return e.id})):(o.replaceWithShape(s,i),this.regionShapes[n]=i.id))},render:function(){var t,i,n,o,s=this.values,a=this.target,r=this.regionShapes;if(this.cls._super.render.call(this)){for(n=s.length;n--;)if(t=this.renderRegion(n))if(e.isArray(t)){for(i=[],o=t.length;o--;)t[o].append(),i.push(t[o].id);r[n]=i}else t.append(),r[n]=t.id;else r[n]=null;a.render()}}},e.fn.sparkline.line=y=i(e.fn.sparkline._base,{type:"line",init:function(e,t,i,n,o){y._super.init.call(this,e,t,i,n,o),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(e,t){var i,n=this.regionMap;for(i=n.length;i--;)if(null!==n[i]&&t>=n[i][0]&&n[i][1]>=t)return n[i][2];return void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:null===this.yvalues[e],x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){var e,t,i=this.currentRegion,n=this.target,o=this.vertices[i],s=this.options,a=s.get("spotRadius"),r=s.get("highlightSpotColor"),l=s.get("highlightLineColor");o&&(a&&r&&(e=n.drawCircle(o[0],o[1],a,void 0,r),this.highlightSpotId=e.id,n.insertAfterShape(this.lastShapeId,e)),l&&(t=n.drawLine(o[0],this.canvasTop,o[0],this.canvasTop+this.canvasHeight,l),this.highlightLineId=t.id,n.insertAfterShape(this.lastShapeId,t)))},removeHighlight:function(){var e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var e,t,i,n,o,s=this.values,a=s.length,r=this.xvalues,l=this.yvalues,c=this.yminmax;for(e=0;a>e;e++)t=s[e],i="string"==typeof s[e],n="object"==typeof s[e]&&s[e]instanceof Array,o=i&&s[e].split(":"),i&&2===o.length?(r.push(Number(o[0])),l.push(Number(o[1])),c.push(Number(o[1]))):n?(r.push(t[0]),l.push(t[1]),c.push(t[1])):(r.push(e),null===s[e]||"null"===s[e]?l.push(null):(l.push(Number(t)),c.push(Number(t))));this.options.get("xvalues")&&(r=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,c),this.miny=this.minyorg=Math.min.apply(Math,c),this.maxx=Math.max.apply(Math,r),this.minx=Math.min.apply(Math,r),this.xvalues=r,this.yvalues=l,this.yminmax=c},processRangeOptions:function(){var e=this.options,t=e.get("normalRangeMin"),i=e.get("normalRangeMax");void 0!==t&&(this.miny>t&&(this.miny=t),i>this.maxy&&(this.maxy=i)),void 0!==e.get("chartRangeMin")&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),void 0!==e.get("chartRangeMax")&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),void 0!==e.get("chartRangeMinX")&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),void 0!==e.get("chartRangeMaxX")&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,t,i,n,o){var s=this.options.get("normalRangeMin"),a=this.options.get("normalRangeMax"),r=t+Math.round(i-i*((a-this.miny)/o)),l=Math.round(i*(a-s)/o);this.target.drawRect(e,r,n,l,void 0,this.options.get("normalRangeColor")).append()},render:function(){var t,i,n,o,s,a,r,l,c,u,h,d,p,f,m,v,b,C,T,_,x,E,w,D,I,k=this.options,S=this.target,O=this.canvasWidth,R=this.canvasHeight,N=this.vertices,A=k.get("spotRadius"),M=this.regionMap;if(y._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),w=this.xvalues,D=this.yvalues,this.yminmax.length&&!(2>this.yvalues.length))){for(o=s=0,t=0===this.maxx-this.minx?1:this.maxx-this.minx,i=0===this.maxy-this.miny?1:this.maxy-this.miny,n=this.yvalues.length-1,A&&(4*A>O||4*A>R)&&(A=0),A&&(x=k.get("highlightSpotColor")&&!k.get("disableInteraction"),(x||k.get("minSpotColor")||k.get("spotColor")&&D[n]===this.miny)&&(R-=Math.ceil(A)),(x||k.get("maxSpotColor")||k.get("spotColor")&&D[n]===this.maxy)&&(R-=Math.ceil(A),o+=Math.ceil(A)),(x||(k.get("minSpotColor")||k.get("maxSpotColor"))&&(D[0]===this.miny||D[0]===this.maxy))&&(s+=Math.ceil(A),O-=Math.ceil(A)),(x||k.get("spotColor")||k.get("minSpotColor")||k.get("maxSpotColor")&&(D[n]===this.miny||D[n]===this.maxy))&&(O-=Math.ceil(A))),R--,void 0!==k.get("normalRangeMin")&&!k.get("drawNormalOnTop")&&this.drawNormalRange(s,o,R,O,i),r=[],l=[r],f=m=null,v=D.length,I=0;v>I;I++)c=w[I],h=w[I+1],u=D[I],d=s+Math.round((c-this.minx)*(O/t)),p=v-1>I?s+Math.round((h-this.minx)*(O/t)):O,m=d+(p-d)/2,M[I]=[f||0,m,I],f=m,null===u?I&&(null!==D[I-1]&&(r=[],l.push(r)),N.push(null)):(this.miny>u&&(u=this.miny),u>this.maxy&&(u=this.maxy),r.length||r.push([d,o+R]),a=[d,o+Math.round(R-R*((u-this.miny)/i))],r.push(a),N.push(a));for(b=[],C=[],T=l.length,I=0;T>I;I++)r=l[I],r.length&&(k.get("fillColor")&&(r.push([r[r.length-1][0],o+R]),C.push(r.slice(0)),r.pop()),r.length>2&&(r[0]=[r[0][0],r[1][1]]),b.push(r));for(T=C.length,I=0;T>I;I++)S.drawShape(C[I],k.get("fillColor"),k.get("fillColor")).append();for(void 0!==k.get("normalRangeMin")&&k.get("drawNormalOnTop")&&this.drawNormalRange(s,o,R,O,i),T=b.length,I=0;T>I;I++)S.drawShape(b[I],k.get("lineColor"),void 0,k.get("lineWidth")).append();if(A&&k.get("valueSpots"))for(_=k.get("valueSpots"),void 0===_.get&&(_=new g(_)),I=0;v>I;I++)E=_.get(D[I]),E&&S.drawCircle(s+Math.round((w[I]-this.minx)*(O/t)),o+Math.round(R-R*((D[I]-this.miny)/i)),A,void 0,E).append();A&&k.get("spotColor")&&S.drawCircle(s+Math.round((w[w.length-1]-this.minx)*(O/t)),o+Math.round(R-R*((D[n]-this.miny)/i)),A,void 0,k.get("spotColor")).append(),this.maxy!==this.minyorg&&(A&&k.get("minSpotColor")&&(c=w[e.inArray(this.minyorg,D)],S.drawCircle(s+Math.round((c-this.minx)*(O/t)),o+Math.round(R-R*((this.minyorg-this.miny)/i)),A,void 0,k.get("minSpotColor")).append()),A&&k.get("maxSpotColor")&&(c=w[e.inArray(this.maxyorg,D)],S.drawCircle(s+Math.round((c-this.minx)*(O/t)),o+Math.round(R-R*((this.maxyorg-this.miny)/i)),A,void 0,k.get("maxSpotColor")).append())),this.lastShapeId=S.getLastShapeId(),this.canvasTop=o,S.render()}}}),e.fn.sparkline.bar=C=i(e.fn.sparkline._base,b,{type:"bar",init:function(t,i,n,s,c){var u,h,d,p,f,m,v,b,y,T,_,x,E,w,D,I,k,S,O,R,N,A,M=parseInt(n.get("barWidth"),10),P=parseInt(n.get("barSpacing"),10),K=n.get("chartRangeMin"),L=n.get("chartRangeMax"),F=n.get("chartRangeClip"),$=1/0,H=-1/0;for(C._super.init.call(this,t,i,n,s,c),m=0,v=i.length;v>m;m++)R=i[m],u="string"==typeof R&&R.indexOf(":")>-1,(u||e.isArray(R))&&(D=!0,u&&(R=i[m]=r(R.split(":"))),R=l(R,null),h=Math.min.apply(Math,R),d=Math.max.apply(Math,R),$>h&&($=h),d>H&&(H=d));this.stacked=D,this.regionShapes={},this.barWidth=M,this.barSpacing=P,this.totalBarWidth=M+P,this.width=s=i.length*M+(i.length-1)*P,this.initTarget(),F&&(E=void 0===K?-1/0:K,w=void 0===L?1/0:L),f=[],p=D?[]:f;var j=[],B=[];for(m=0,v=i.length;v>m;m++)if(D)for(I=i[m],i[m]=O=[],j[m]=0,p[m]=B[m]=0,k=0,S=I.length;S>k;k++)R=O[k]=F?o(I[k],E,w):I[k],null!==R&&(R>0&&(j[m]+=R),0>$&&H>0?0>R?B[m]+=Math.abs(R):p[m]+=R:p[m]+=Math.abs(R-(0>R?H:$)),f.push(R));else R=F?o(i[m],E,w):i[m],R=i[m]=a(R),null!==R&&f.push(R);this.max=x=Math.max.apply(Math,f),this.min=_=Math.min.apply(Math,f),this.stackMax=H=D?Math.max.apply(Math,j):x,this.stackMin=$=D?Math.min.apply(Math,f):_,void 0!==n.get("chartRangeMin")&&(n.get("chartRangeClip")||_>n.get("chartRangeMin"))&&(_=n.get("chartRangeMin")),void 0!==n.get("chartRangeMax")&&(n.get("chartRangeClip")||n.get("chartRangeMax")>x)&&(x=n.get("chartRangeMax")),this.zeroAxis=y=n.get("zeroAxis",!0),T=0>=_&&x>=0&&y?0:0==y?_:_>0?_:x,this.xaxisOffset=T,b=D?Math.max.apply(Math,p)+Math.max.apply(Math,B):x-_,this.canvasHeightEf=y&&0>_?this.canvasHeight-2:this.canvasHeight-1,T>_?(A=D&&x>=0?H:x,N=(A-T)/b*this.canvasHeight,N!==Math.ceil(N)&&(this.canvasHeightEf-=2,N=Math.ceil(N))):N=this.canvasHeight,this.yoffset=N,e.isArray(n.get("colorMap"))?(this.colorMapByIndex=n.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=n.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new g(this.colorMapByValue))),this.range=b},getRegion:function(e,t){var i=Math.floor(t/this.totalBarWidth);return 0>i||i>=this.values.length?void 0:i},getCurrentRegionFields:function(){var e,t,i=this.currentRegion,n=p(this.values[i]),o=[];for(t=n.length;t--;)e=n[t],o.push({isNull:null===e,value:e,color:this.calcColor(t,e,i),offset:i});return o},calcColor:function(t,i,n){var o,s,a=this.colorMapByIndex,r=this.colorMapByValue,l=this.options;return o=this.stacked?l.get("stackedBarColor"):0>i?l.get("negBarColor"):l.get("barColor"),0===i&&void 0!==l.get("zeroColor")&&(o=l.get("zeroColor")),r&&(s=r.get(i))?o=s:a&&a.length>n&&(o=a[n]),e.isArray(o)?o[t%o.length]:o},renderRegion:function(t,i){var n,o,s,a,r,l,c,h,d,p,f=this.values[t],g=this.options,m=this.xaxisOffset,v=[],b=this.range,y=this.stacked,C=this.target,T=t*this.totalBarWidth,_=this.canvasHeightEf,x=this.yoffset;if(f=e.isArray(f)?f:[f],c=f.length,h=f[0],a=u(null,f),p=u(m,f,!0),a)return g.get("nullColor")?(s=i?g.get("nullColor"):this.calcHighlightColor(g.get("nullColor"),g),n=x>0?x-1:x,C.drawRect(T,n,this.barWidth-1,0,s,s)):void 0;for(r=x,l=0;c>l;l++){if(h=f[l],y&&h===m){if(!p||d)continue;d=!0}o=b>0?Math.floor(_*(Math.abs(h-m)/b))+1:1,m>h||h===m&&0===x?(n=r,r+=o):(n=x-o,x-=o),s=this.calcColor(l,h,t),i&&(s=this.calcHighlightColor(s,g)),v.push(C.drawRect(T,n,this.barWidth-1,o-1,s,s))}return 1===v.length?v[0]:v}}),e.fn.sparkline.tristate=T=i(e.fn.sparkline._base,b,{type:"tristate",init:function(t,i,n,o,s){var a=parseInt(n.get("barWidth"),10),r=parseInt(n.get("barSpacing"),10);T._super.init.call(this,t,i,n,o,s),this.regionShapes={},this.barWidth=a,this.barSpacing=r,this.totalBarWidth=a+r,this.values=e.map(i,Number),this.width=o=i.length*a+(i.length-1)*r,e.isArray(n.get("colorMap"))?(this.colorMapByIndex=n.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=n.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new g(this.colorMapByValue))),this.initTarget()},getRegion:function(e,t){return Math.floor(t/this.totalBarWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,t){var i,n,o=this.values,s=this.options,a=this.colorMapByIndex,r=this.colorMapByValue;return i=r&&(n=r.get(e))?n:a&&a.length>t?a[t]:0>o[t]?s.get("negBarColor"):o[t]>0?s.get("posBarColor"):s.get("zeroBarColor")},renderRegion:function(e,t){var i,n,o,s,a,r,l=this.values,c=this.options,u=this.target;return i=u.pixelHeight,o=Math.round(i/2),s=e*this.totalBarWidth,0>l[e]?(a=o,n=o-1):l[e]>0?(a=0,n=o-1):(a=o-1,n=2),r=this.calcColor(l[e],e),null!==r?(t&&(r=this.calcHighlightColor(r,c)),u.drawRect(s,a,this.barWidth-1,n-1,r,r)):void 0}}),e.fn.sparkline.discrete=_=i(e.fn.sparkline._base,b,{type:"discrete",init:function(t,i,n,o,s){_._super.init.call(this,t,i,n,o,s),this.regionShapes={},this.values=i=e.map(i,Number),this.min=Math.min.apply(Math,i),this.max=Math.max.apply(Math,i),this.range=this.max-this.min,this.width=o="auto"===n.get("width")?2*i.length:this.width,this.interval=Math.floor(o/i.length),this.itemWidth=o/i.length,void 0!==n.get("chartRangeMin")&&(n.get("chartRangeClip")||n.get("chartRangeMin")<this.min)&&(this.min=n.get("chartRangeMin")),void 0!==n.get("chartRangeMax")&&(n.get("chartRangeClip")||n.get("chartRangeMax")>this.max)&&(this.max=n.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===n.get("lineHeight")?Math.round(.3*this.canvasHeight):n.get("lineHeight"))},getRegion:function(e,t){return Math.floor(t/this.itemWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],offset:e}},renderRegion:function(e,t){var i,n,s,a,r=this.values,l=this.options,c=this.min,u=this.max,h=this.range,d=this.interval,p=this.target,f=this.canvasHeight,g=this.lineHeight,m=f-g;return n=o(r[e],c,u),a=e*d,i=Math.round(m-m*((n-c)/h)),s=l.get("thresholdColor")&&l.get("thresholdValue")>n?l.get("thresholdColor"):l.get("lineColor"),t&&(s=this.calcHighlightColor(s,l)),p.drawLine(a,i,a,i+g,s)}}),e.fn.sparkline.bullet=x=i(e.fn.sparkline._base,{type:"bullet",init:function(e,t,i,n,o){var s,a,l;x._super.init.call(this,e,t,i,n,o),this.values=t=r(t),l=t.slice(),l[0]=null===l[0]?l[2]:l[0],l[1]=null===t[1]?l[2]:l[1],s=Math.min.apply(Math,t),a=Math.max.apply(Math,t),s=void 0===i.get("base")?0>s?s:0:i.get("base"),this.min=s,this.max=a,this.range=a-s,this.shapes={},this.valueShapes={},this.regiondata={},this.width=n="auto"===i.get("width")?"4.0em":n,this.target=this.$el.simpledraw(n,o,i.get("composite")),t.length||(this.disabled=!0),this.initTarget()},getRegion:function(e,t,i){var n=this.target.getShapeAt(e,t,i);return void 0!==n&&void 0!==this.shapes[n]?this.shapes[n]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){var t,i=this.currentRegion,n=this.valueShapes[i];switch(delete this.shapes[n],i.substr(0,1)){case"r":t=this.renderRange(i.substr(1),e);break;case"p":t=this.renderPerformance(e);break;case"t":t=this.renderTarget(e)}this.valueShapes[i]=t.id,this.shapes[t.id]=i,this.target.replaceWithShape(n,t)},renderRange:function(e,t){var i=this.values[e],n=Math.round(this.canvasWidth*((i-this.min)/this.range)),o=this.options.get("rangeColors")[e-2];return t&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(0,0,n-1,this.canvasHeight-1,o,o)},renderPerformance:function(e){var t=this.values[1],i=Math.round(this.canvasWidth*((t-this.min)/this.range)),n=this.options.get("performanceColor");return e&&(n=this.calcHighlightColor(n,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),i-1,Math.round(.4*this.canvasHeight)-1,n,n)},renderTarget:function(e){var t=this.values[0],i=Math.round(this.canvasWidth*((t-this.min)/this.range)-this.options.get("targetWidth")/2),n=Math.round(.1*this.canvasHeight),o=this.canvasHeight-2*n,s=this.options.get("targetColor");return e&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(i,n,this.options.get("targetWidth")-1,o-1,s,s)},render:function(){var e,t,i=this.values.length,n=this.target;if(x._super.render.call(this)){for(e=2;i>e;e++)t=this.renderRange(e).append(),this.shapes[t.id]="r"+e,this.valueShapes["r"+e]=t.id;null!==this.values[1]&&(t=this.renderPerformance().append(),this.shapes[t.id]="p1",this.valueShapes.p1=t.id),null!==this.values[0]&&(t=this.renderTarget().append(),this.shapes[t.id]="t0",this.valueShapes.t0=t.id),n.render()}}}),e.fn.sparkline.pie=E=i(e.fn.sparkline._base,{type:"pie",init:function(t,i,n,o,s){var a,r=0;if(E._super.init.call(this,t,i,n,o,s),this.shapes={},this.valueShapes={},this.values=i=e.map(i,Number),"auto"===n.get("width")&&(this.width=this.height),i.length>0)for(a=i.length;a--;)r+=i[a];this.total=r,this.initTarget(),this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,t,i){var n=this.target.getShapeAt(e,t,i);return void 0!==n&&void 0!==this.shapes[n]?this.shapes[n]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],percent:100*(this.values[e]/this.total),color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){var t=this.currentRegion,i=this.renderSlice(t,e),n=this.valueShapes[t];delete this.shapes[n],this.target.replaceWithShape(n,i),this.valueShapes[t]=i.id,this.shapes[i.id]=t},renderSlice:function(e,t){var i,n,o,s,a,r=this.target,l=this.options,c=this.radius,u=l.get("borderWidth"),h=l.get("offset"),d=2*Math.PI,p=this.values,f=this.total,g=h?2*Math.PI*(h/360):0;for(s=p.length,o=0;s>o;o++){if(i=g,n=g,f>0&&(n=g+d*(p[o]/f)),e===o)return a=l.get("sliceColors")[o%l.get("sliceColors").length],t&&(a=this.calcHighlightColor(a,l)),r.drawPieSlice(c,c,c-u,i,n,void 0,a);g=n}},render:function(){var e,t,i=this.target,n=this.values,o=this.options,s=this.radius,a=o.get("borderWidth");if(E._super.render.call(this)){for(a&&i.drawCircle(s,s,Math.floor(s-a/2),o.get("borderColor"),void 0,a).append(),t=n.length;t--;)n[t]&&(e=this.renderSlice(t).append(),this.valueShapes[t]=e.id,this.shapes[e.id]=t);i.render()}}}),e.fn.sparkline.box=w=i(e.fn.sparkline._base,{type:"box",init:function(t,i,n,o,s){w._super.init.call(this,t,i,n,o,s),this.values=e.map(i,Number),this.width="auto"===n.get("width")?"4.0em":o,this.initTarget(),this.values.length||(this.disabled=1)
},getRegion:function(){return 1},getCurrentRegionFields:function(){var e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return void 0!==this.loutlier&&e.push({field:"lo",value:this.loutlier}),void 0!==this.routlier&&e.push({field:"ro",value:this.routlier}),void 0!==this.lwhisker&&e.push({field:"lw",value:this.lwhisker}),void 0!==this.rwhisker&&e.push({field:"rw",value:this.rwhisker}),e},render:function(){var e,t,i,n,o,a,r,l,c,u,h,d=this.target,p=this.values,f=p.length,g=this.options,m=this.canvasWidth,v=this.canvasHeight,b=void 0===g.get("chartRangeMin")?Math.min.apply(Math,p):g.get("chartRangeMin"),y=void 0===g.get("chartRangeMax")?Math.max.apply(Math,p):g.get("chartRangeMax"),C=0;if(w._super.render.call(this)){if(g.get("raw"))g.get("showOutliers")&&p.length>5?(t=p[0],e=p[1],n=p[2],o=p[3],a=p[4],r=p[5],l=p[6]):(e=p[0],n=p[1],o=p[2],a=p[3],r=p[4]);else if(p.sort(function(e,t){return e-t}),n=s(p,1),o=s(p,2),a=s(p,3),i=a-n,g.get("showOutliers")){for(e=r=void 0,c=0;f>c;c++)void 0===e&&p[c]>n-i*g.get("outlierIQR")&&(e=p[c]),p[c]<a+i*g.get("outlierIQR")&&(r=p[c]);t=p[0],l=p[f-1]}else e=p[0],r=p[f-1];this.quartiles=[n,o,a],this.lwhisker=e,this.rwhisker=r,this.loutlier=t,this.routlier=l,h=m/(y-b+1),g.get("showOutliers")&&(C=Math.ceil(g.get("spotRadius")),m-=2*Math.ceil(g.get("spotRadius")),h=m/(y-b+1),e>t&&d.drawCircle((t-b)*h+C,v/2,g.get("spotRadius"),g.get("outlierLineColor"),g.get("outlierFillColor")).append(),l>r&&d.drawCircle((l-b)*h+C,v/2,g.get("spotRadius"),g.get("outlierLineColor"),g.get("outlierFillColor")).append()),d.drawRect(Math.round((n-b)*h+C),Math.round(.1*v),Math.round((a-n)*h),Math.round(.8*v),g.get("boxLineColor"),g.get("boxFillColor")).append(),d.drawLine(Math.round((e-b)*h+C),Math.round(v/2),Math.round((n-b)*h+C),Math.round(v/2),g.get("lineColor")).append(),d.drawLine(Math.round((e-b)*h+C),Math.round(v/4),Math.round((e-b)*h+C),Math.round(v-v/4),g.get("whiskerColor")).append(),d.drawLine(Math.round((r-b)*h+C),Math.round(v/2),Math.round((a-b)*h+C),Math.round(v/2),g.get("lineColor")).append(),d.drawLine(Math.round((r-b)*h+C),Math.round(v/4),Math.round((r-b)*h+C),Math.round(v-v/4),g.get("whiskerColor")).append(),d.drawLine(Math.round((o-b)*h+C),Math.round(.1*v),Math.round((o-b)*h+C),Math.round(.9*v),g.get("medianColor")).append(),g.get("target")&&(u=Math.ceil(g.get("spotRadius")),d.drawLine(Math.round((g.get("target")-b)*h+C),Math.round(v/2-u),Math.round((g.get("target")-b)*h+C),Math.round(v/2+u),g.get("targetColor")).append(),d.drawLine(Math.round((g.get("target")-b)*h+C-u),Math.round(v/2),Math.round((g.get("target")-b)*h+C+u),Math.round(v/2),g.get("targetColor")).append()),d.render()}}}),e.browser.msie&&document.namespaces&&!document.namespaces.v&&document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),void 0===e.browser.hasCanvas&&(e.browser.hasCanvas=void 0!==document.createElement("canvas").getContext),k=i({init:function(e,t,i,n){this.target=e,this.id=t,this.type=i,this.args=n},append:function(){return this.target.appendShape(this),this}}),S=i({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,i,n){t&&(this.width=t,this.height=i,this.target=n,this.lastShapeId=null,n[0]&&(n=n[0]),e.data(n,"_jqs_vcanvas",this))},drawLine:function(e,t,i,n,o,s){return this.drawShape([[e,t],[i,n]],o,s)},drawShape:function(e,t,i,n){return this._genShape("Shape",[e,t,i,n])},drawCircle:function(e,t,i,n,o,s){return this._genShape("Circle",[e,t,i,n,o,s])},drawPieSlice:function(e,t,i,n,o,s,a){return this._genShape("PieSlice",[e,t,i,n,o,s,a])},drawRect:function(e,t,i,n,o,s){return this._genShape("Rect",[e,t,i,n,o,s])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,i){e(i).html(t)},_calculatePixelDims:function(t,i,n){var o;o=this._pxregex.exec(i),this.pixelHeight=o?o[1]:e(n).height(),o=this._pxregex.exec(t),this.pixelWidth=o?o[1]:e(n).width()},_genShape:function(e,t){var i=M++;return t.unshift(i),new k(this,i,e,t)},appendShape:function(){alert("appendShape not implemented")},replaceWithShape:function(){alert("replaceWithShape not implemented")},insertAfterShape:function(){alert("insertAfterShape not implemented")},removeShapeId:function(){alert("removeShapeId not implemented")},getShapeAt:function(){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),O=i(S,{init:function(t,i,n,o){O._super.init.call(this,t,i,n),this.canvas=document.createElement("canvas"),n[0]&&(n=n[0]),e.data(n,"_jqs_vcanvas",this),e(this.canvas).css({display:"inline-block",width:t,height:i,verticalAlign:"top"}),this._insert(this.canvas,n),this._calculatePixelDims(t,i,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=o,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0,e(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(e,t,i){var n=this.canvas.getContext("2d");return void 0!==e&&(n.strokeStyle=e),n.lineWidth=void 0===i?1:i,void 0!==t&&(n.fillStyle=t),n},reset:function(){var e=this._getContext();e.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,t,i,n,o){var s,a,r=this._getContext(i,n,o);for(r.beginPath(),r.moveTo(t[0][0]+.5,t[0][1]+.5),s=1,a=t.length;a>s;s++)r.lineTo(t[s][0]+.5,t[s][1]+.5);void 0!==i&&r.stroke(),void 0!==n&&r.fill(),void 0!==this.targetX&&void 0!==this.targetY&&r.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,t,i,n,o,s,a){var r=this._getContext(o,s,a);r.beginPath(),r.arc(t,i,n,0,2*Math.PI,!1),void 0!==this.targetX&&void 0!==this.targetY&&r.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=e),void 0!==o&&r.stroke(),void 0!==s&&r.fill()},_drawPieSlice:function(e,t,i,n,o,s,a,r){var l=this._getContext(a,r);l.beginPath(),l.moveTo(t,i),l.arc(t,i,n,o,s,!1),l.lineTo(t,i),l.closePath(),void 0!==a&&l.stroke(),r&&l.fill(),void 0!==this.targetX&&void 0!==this.targetY&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,t,i,n,o,s,a){return this._drawShape(e,[[t,i],[t+n,i],[t+n,i+o],[t,i+o],[t,i]],s,a)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,t){var i,n=this.shapeseq;for(this.shapes[t.id]=t,i=n.length;i--;)n[i]==e&&(n[i]=t.id);delete this.shapes[e]},replaceWithShapes:function(e,t){var i,n,o,s=this.shapeseq,a={};for(n=e.length;n--;)a[e[n]]=!0;for(n=s.length;n--;)i=s[n],a[i]&&(s.splice(n,1),delete this.shapes[i],o=n);for(n=t.length;n--;)s.splice(o,0,t[n].id),this.shapes[t[n].id]=t[n]},insertAfterShape:function(e,t){var i,n=this.shapeseq;for(i=n.length;i--;)if(n[i]===e)return n.splice(i+1,0,t.id),this.shapes[t.id]=t,void 0},removeShapeId:function(e){var t,i=this.shapeseq;for(t=i.length;t--;)if(i[t]===e){i.splice(t,1);break}delete this.shapes[e]},getShapeAt:function(e,t,i){return this.targetX=t,this.targetY=i,this.render(),this.currentTargetShapeId},render:function(){var e,t,i,n=this.shapeseq,o=this.shapes,s=n.length,a=this._getContext();for(a.clearRect(0,0,this.pixelWidth,this.pixelHeight),i=0;s>i;i++)e=n[i],t=o[e],this["_draw"+t.type].apply(this,t.args);this.interact||(this.shapes={},this.shapeseq=[])}}),R=i(S,{init:function(t,i,n){var o;R._super.init.call(this,t,i,n),n[0]&&(n=n[0]),e.data(n,"_jqs_vcanvas",this),this.canvas=document.createElement("span"),e(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:t,height:i,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,n),this._calculatePixelDims(t,i,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,o='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"'+' style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",o),this.group=e(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(e,t,i,n,o){var s,a,r,l,c,u,h,d=[];for(h=0,u=t.length;u>h;h++)d[h]=""+t[h][0]+","+t[h][1];return s=d.splice(0,1),o=void 0===o?1:o,a=void 0===i?' stroked="false" ':' strokeWeight="'+o+'px" strokeColor="'+i+'" ',r=void 0===n?' filled="false"':' fillColor="'+n+'" filled="true" ',l=d[0]===d[d.length-1]?"x ":"",c='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+e+'" '+a+r+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+s+" l "+d.join(", ")+" "+l+'e">'+" </v:shape>"},_drawCircle:function(e,t,i,n,o,s,a){var r,l,c;return t-=n,i-=n,r=void 0===o?' stroked="false" ':' strokeWeight="'+a+'px" strokeColor="'+o+'" ',l=void 0===s?' filled="false"':' fillColor="'+s+'" filled="true" ',c='<v:oval  id="jqsshape'+e+'" '+r+l+' style="position:absolute;top:'+i+"px; left:"+t+"px; width:"+2*n+"px; height:"+2*n+'px"></v:oval>'},_drawPieSlice:function(e,t,i,n,o,s,a,r){var l,c,u,h,d,p,f,g;if(o!==s&&(s-o===2*Math.PI&&(o=0,s=2*Math.PI),c=t+Math.round(Math.cos(o)*n),u=i+Math.round(Math.sin(o)*n),h=t+Math.round(Math.cos(s)*n),d=i+Math.round(Math.sin(s)*n),!(c===h&&u===d&&Math.PI>s-o)))return l=[t-n,i-n,t+n,i+n,c,u,h,d],p=void 0===a?' stroked="false" ':' strokeWeight="1px" strokeColor="'+a+'" ',f=void 0===r?' filled="false"':' fillColor="'+r+'" filled="true" ',g='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+e+'" '+p+f+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+t+","+i+" wa "+l.join(", ")+' x e">'+" </v:shape>"},_drawRect:function(e,t,i,n,o,s,a){return this._drawShape(e,[[t,i],[t,i+o],[t+n,i+o],[t+n,i],[t,i]],s,a)},reset:function(){this.group.innerHTML=""},appendShape:function(e){var t=this["_draw"+e.type].apply(this,e.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",t):this.prerender+=t,this.lastShapeId=e.id,e.id},replaceWithShape:function(t,i){var n=e("#jqsshape"+t),o=this["_draw"+i.type].apply(this,i.args);n[0].outerHTML=o},replaceWithShapes:function(t,i){var n,o=e("#jqsshape"+t[0]),s="",a=i.length;for(n=0;a>n;n++)s+=this["_draw"+i[n].type].apply(this,i[n].args);for(o[0].outerHTML=s,n=1;t.length>n;n++)e("#jqsshape"+t[n]).remove()},insertAfterShape:function(t,i){var n=e("#jqsshape"+t),o=this["_draw"+i.type].apply(this,i.args);n[0].insertAdjacentHTML("afterEnd",o)},removeShapeId:function(t){var i=e("#jqsshape"+t);this.group.removeChild(i[0])},getShapeAt:function(e){var t=e.id.substr(8);return t},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})});